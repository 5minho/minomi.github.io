---
layout: post
title: 대규모 서비스를 지탱하는 기술 chapter 03-1
comments: true
tags:
- CS
- 대규모 서비스를 지탱하는 기술
- OS
- cache
---

OS 는 메모리를 이용해서 디스크 액세스를 줄임. 그 원리는 OS 캐시. Linux 의 경우  페이지 캐시 라고 하는 캐시 구조를 갖추고 있음.

#### 리눅스의 페이지 캐시
프로세스가 특정 디스크에 있는 특정 데이터가 필요할 때 프로세스는 바로 디스크에 있는 데이터를 가져다 쓸  수 없다. <br/>프로세스는 OS 에게 디스크의 데이터를 요청하게 되고 OS 가 디스크에 프로세스가 필요한 `데이터가 포함된 블록 (페이지 크기)` 만큼 읽어서 메모리에 쓰고 그 데이터를 프로세스가 접근하게 한다. <br/>
이 때 OS 가 페이지 크기만큼 메모리에 쓴 데이터 블록을 페이지 캐시라고 하고 프로세스가 이 데이터를 다 써서 접근할 필요가 없다 하더라도 OS 는 메모리에 이 데이터를 계속 남겨두게 된다.

#### 어떻게 캐시할까?

OS 는 어떻게 파일의 일부분을 페이지 크기 만큼 읽어서 캐시할까? <br/>
Linux 같은 경우 파일을 i node 번호로 식별하며 해당 파일의 i node 번호와, 어느 위치부터 읽어낼지를 나타내는 오프셋 이 두 가지 값을 키로 캐싱을 한다. <br/>
이 키(inode, offset) 로 부터 해당 페이지를 찾을때는 [Radix tree](http://jake.dothome.co.kr/radix-tree/) 라는 자료구조를 이용하여 파일이 아무리 커지더라도 캐시탐색 속도가 떨어지지 않도록 한다.
 
